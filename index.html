<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>asari2025</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <style>
    body, html {
      margin: 0;
      padding: 0;
      font-family: sans-serif;
      background: #f9f9f9;
    }
    .page { display: none; padding: 20px; }
    .active { display: block; }

    /* ====== スマホ専用警告 ====== */
    #pc-warning {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: #000;
      color: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 20px;
      text-align: center;
      padding: 20px;
      z-index: 2000;
    }

    /* ====== ポップアップ動画 ====== */
    .overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.9);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1500;
    }
    .overlay iframe {
      width: 90%;
      height: 50%;
      border-radius: 12px;
    }
    .close-btn {
      position: absolute;
      top: 10px; right: 20px;
      background: #fff;
      border: none;
      padding: 10px 16px;
      cursor: pointer;
      border-radius: 8px;
      font-size: 16px;
    }

    /* ====== タイトル画面 ====== */
    .title-section {
      height: 100vh;
      background: url('title.jpg') no-repeat center center/cover;
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 32px;
      font-weight: bold;
    }
    .story-section, .desc-section {
      padding: 60px 20px;
      text-align: center;
    }
    .start-btn {
      display: inline-block;
      padding: 14px 28px;
      background: #0078ff;
      color: #fff;
      border-radius: 12px;
      text-decoration: none;
      font-size: 18px;
      margin-top: 20px;
    }

    /* ====== ハンバーガーメニュー ====== */
    .hamburger {
      position: fixed;
      top: 16px; right: 16px;
      cursor: pointer;
      z-index: 1600;
      width: 30px; height: 22px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }
    .hamburger div {
      height: 4px;
      background: black;
      border-radius: 2px;
    }

    .menu {
      position: fixed;
      top: 0;
      right: 0;
      width: 200px;
      height: 100%;
      background: #fff;
      box-shadow: -2px 0 5px rgba(0,0,0,0.3);
      transform: translateX(100%); /* 初期状態は画面外 */
      transition: transform 0.3s ease;
      z-index: 9999;
    }

    /* 開いたとき */
    .menu.open {
      transform: translateX(0);
    }
    .menu a.locked {
      color: gray;
      pointer-events: none;
    }


    /* 開いたときに表示 */
    #menu.open {
      transform: translateX(0);
    }

    /* ====== 入力フォーム ====== */
    input {
      padding: 10px;
      margin: 10px;
      font-size: 18px;
      width: 80%;
      max-width: 300px;
    }
    button {
      padding: 10px 18px;
      font-size: 16px;
      margin-top: 10px;
    }
  </style>
</head>
<body>

  <!-- PC/横画面用警告 -->
  <div id="pc-warning">⚠️ このサイトはスマホ専用です。<br>スマホを縦向きにしてご利用ください。</div>

  <!-- ====== ポップアップ動画 ====== -->
  <div id="overlay" class="overlay">
    <iframe src="https://www.youtube.com/embed/【動画ID】" frameborder="0" allowfullscreen></iframe>
    <button class="close-btn" onclick="closeOverlay()">閉じる ✕</button>
  </div>

  <!-- ====== ハンバーガーメニュー ====== -->
  <div class="hamburger">
    <div></div>
    <div></div>
    <div></div>
  </div>

  <div id="menu" class="menu">
    <a href="#" onclick="goToStep('title')" id="menu-title">はじめに</a>
    <a href="#" onclick="goToStep('step1', event)" id="menu-step1">STEP1</a>
    <a href="#" onclick="goToStep('step2', event)" id="menu-step2" class="locked">STEP2</a>
    <a href="#" onclick="goToStep('step3', event)" id="menu-step3" class="locked">STEP3</a>
    <a href="#" onclick="goToStep('laststep', event)" id="menu-last" class="locked">LAST</a>
  </div>

  <!-- ====== タイトルページ ====== -->
  <div id="title" class="page active">
    <div class="title-section">asari2025</div>
    <div class="story-section">
      <h2>Story</h2>
      <p>ここに物語の導入を書く。</p>
    </div>
    <div class="desc-section">
      <h2>説明</h2>
      <p>ルールや遊び方をここに書く。</p>
      <button class="start-btn" onclick="goToStep('step1')">STEP1へ進む</button>
    </div>
  </div>

  <!-- STEPページ -->
  <div id="step1" class="step-page">
    <!-- Storyポップアップ -->
    <div class="story-popup" id="story1">
      <img src="story1.jpg" alt="Story1">
      <button onclick="closeStory(1)">閉じる</button>
    </div>

    <!-- 6つの正方形ボタン -->
    <div class="problem-grid">
      <button onclick="goProblem(1,1)">1</button>
      <button onclick="goProblem(1,2)">2</button>
      <button onclick="goProblem(1,3)">3</button>
      <button onclick="goProblem(1,4)">4</button>
      <button onclick="goProblem(1,5)">5</button>
      <button onclick="goProblem(1,6)">6</button>
    </div>

    <!-- 指示文 -->
    <div class="instruction">
      <p>ここに指示文</p>
      <input type="text" id="step1-input">
      <button onclick="checkStepAnswer(1)">決定</button>
    </div>
  </div>

  <!-- 小問題ページ -->
  <div id="step1-problem1" class="problem-page">
    <h2>問題1</h2>
    <img src="problem1.jpg" alt="問題1">
    <input type="text" id="answer1-1">
    <button onclick="checkProblemAnswer(1,1)">決定</button>
    <button onclick="goBackStep(1)">戻る</button>
  </div>


  <!-- STEP2 -->
  <div id="step2" class="page step-page">
    <h2>STEP2</h2>
    <p>(正解: あさり)</p>
    <input type="text" id="answer2"><br>
    <button onclick="checkAnswer(2)">送信</button>
  </div>

  <!-- STEP3 -->
  <div id="step3" class="page step-page">
    <h2>STEP3</h2>
    <p>(正解: えにぐま)</p>
    <input type="text" id="answer3"><br>
    <button onclick="checkAnswer(3)">送信</button>
  </div>

  <!-- LAST -->
  <div id="laststep" class="page">
    <h2>LAST STEP</h2>
    <p>🎉 クリア！おめでとう 🎉</p>
  </div>

  <script>
    const answers = {1:"ひろとん", 2:"あさり", 3:"えにぐま"};

    // スマホ判定
    function checkDevice(){
      if(window.innerWidth > window.innerHeight){
        document.getElementById("pc-warning").style.display="flex";
      } else {
        document.getElementById("pc-warning").style.display="none";
        document.querySelector(".hamburger").style.display = "flex";
      }
    }
    window.addEventListener("resize", checkDevice);
    window.addEventListener("load", checkDevice);

    // 動画ポップアップ
    function closeOverlay(){ document.getElementById("overlay").style.display="none"; }

    // メニュー開閉
    function toggleMenu() {
      document.getElementById("menu").classList.toggle("open");
    }

    // ハンバーガーメニューのイベント
    document.querySelector(".hamburger").addEventListener("click", toggleMenu);

    // ページ切り替え
    function goToStep(stepId, event){
      if(event) event.preventDefault();
      document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"));
      document.getElementById(stepId).classList.add("active");
      // メニューを閉じる
      document.getElementById("menu").classList.remove("open");
    }

    function openStory(step) {
      document.getElementById(`story${step}`).style.display = 'flex';
    }
    function closeStory(step) {
      document.getElementById(`story${step}`).style.display = 'none';
    }

    function goProblem(step, num) {
      document.querySelectorAll('.step-page, .problem-page').forEach(p => p.style.display='none');
      document.getElementById(`step${step}-problem${num}`).style.display = 'block';
    }

    function checkProblemAnswer(step, num) {
      const input = document.getElementById(`answer${step}-${num}`).value.trim();
      if(input === correctAnswers[step][num]) {
        alert("正解！");
        // 小問題をクリアしたフラグを管理
      } else {
        alert("不正解！");
      }
    }

    function goBackStep(step) {
      // すべてのSTEPページと小問題ページを非表示
      document.querySelectorAll('.step-page, .problem-page').forEach(p => p.style.display = 'none');

      // 指定されたSTEPページを表示
      document.getElementById(`step${step}`).style.display = 'block';
    }

    function checkStepAnswer(step) {
      const input = document.getElementById(`step${step}-input`).value.trim();
      if(input === stepCorrect[step]) {
        goStep(step + 1); // 次STEPへ
      } else {
        alert("違うよ！");
      }
    }

    // 答え判定
    function checkAnswer(step){
      let input = document.getElementById(`answer${step}`).value.trim();
      if(input === answers[step]){
        alert("正解！");
        unlockMenu(step+1);
        if(step<3){
          goToStep(`step${step+1}`);
        } else {
          document.getElementById("menu-last").classList.remove("locked");
          goToStep("laststep");
        }
      } else {
        alert("不正解！");
      }
    }

    function goProblem(step, num) {
      // すべての小問題ページだけ非表示
      document.querySelectorAll('.problem-page').forEach(p => p.style.display='none');
      // 指定の小問題ページを表示
      document.getElementById(`step${step}-problem${num}`).style.display = 'block';
      // STEPページは非表示にする
      document.getElementById(`step${step}`).style.display = 'none';
    }


    // メニュー解放
    function unlockMenu(step){
      if(step===1) document.getElementById("menu-step1").classList.remove("locked");
      if(step===2) document.getElementById("menu-step2").classList.remove("locked");
      if(step===3) document.getElementById("menu-step3").classList.remove("locked");
    }

  </script>

</body>
</html>
