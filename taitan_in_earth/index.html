<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <title>STEPページ</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../style.css" />
  </head>
  <body class="no-scroll">
    <div style="background: #fff; padding: 20px; border-radius: 8px">
      <h1>お知らせ</h1>
      最終問題に不具合が発生しており、現在調整中です。
      調整が完了次第Twitterで告知するので今しばらくお待ちください
      <a href="https://x.com/bluebery1001"
        >このアカウントで告知します(https://x.com/bluebery1001)</a
      >
    <!--</br>不具合調整が完了しました。小問1つに変更点があります。</br>ご確認ください。-->
    </div>
   
    <!-- <div id="pc-warning">※スマホ専用サイトです。スマートフォンでご利用ください。</div> -->
    <h2 class="story-title">～STORY～</h2>
    <section id="story-section-step4" class="step-story-section active">
      <div class="story-chat">
        <div class="message alien">
          <img src="../images/marubatu_are.png" alt="alien icon" class="icon" />
          <div class="chat alien">
            マスを壊して盤面を広げ、さらに私の口を封じて制止を振り切るとは…見事です。
          </div>
        </div>
        <div class="message user">
          <div class="chat user">やった〜！これで宇宙船を動かせるね！</div>
          <img src="../images/user_icon.png" alt="user icon" class="icon" />
        </div>

        <div class="message alien">
          <img src="../images/alien_icon2.png" alt="alien icon" class="icon" />
          <div class="chat alien">
            君のおかげで宇宙の旅に戻れる！<br />本当にありがとう！
          </div>
        </div>
        <div class="message user">
          <div class="chat user">楽しかったよ！</div>
          <img src="../images/user_icon.png" alt="user icon" class="icon" />
        </div>

        <div class="message alien">
          <img src="../images/alien_icon2.png" alt="alien icon" class="icon" />
          <div class="chat alien">また会おうね！</div>
        </div>
        <div class="message user">
          <div class="chat user">
            また宇宙船が墜落しないように気をつけてね！
          </div>
          <img src="../images/user_icon.png" alt="user icon" class="icon" />
        </div>

        <div class="message alien">
          <img src="../images/alien_icon2.png" alt="alien icon" class="icon" />
          <div class="chat alien">き、気をつけるよ…</div>
        </div>
      </div>
    </section>

    <h1 id="final-problem" style="color: rgb(83, 83, 83)">最終問題</h1>
    <div class="final-title-container">
      <div class="final-title-frame">
        <div class="final-title-text">
          タイタンを地球から<br />宇宙に帰還させよう
        </div>
      </div>
    </div>

    <section id="final-section">
      <div class="final-panel">
        <details class="method-details">
          <summary class="final-subtitle">帰還のヒント</summary>
          <div class="method-area">
            <div class="method-row">
              <span class="badge">①</span>
              <span class="method-text">の</span>
              <span class="badge">②</span>
              <span class="method-text">を</span>
            </div>
            <div class="method-row">
              <span class="badge">③</span>
              <span class="method-text">に</span>
              <span class="badge">④</span>
            </div>
          </div>

          <div class="words-title">①〜④に入る言葉</div>
          <div class="words-box">
            <div class="words-grid" id="words-grid">
              <!-- Words will be populated and shuffled by JavaScript -->
            </div>
          </div>
        </details>
      </div>
    </section>

    <!-- Help button -->
    <button id="help-btn" style="display: block; margin: 20px auto; max-width: 420px;">やることはわかったがどうしてもできない場合はこちら</button>
    
    <!-- Help section -->
    <div id="help-section" style="display: none; margin-top: 20px; max-width: 420px; margin-left: auto; margin-right: auto;">
      <p style="font-size: 18px; margin-bottom: 10px; text-align: center;">帰還方法を入力してください。</br>「①の②を③に④」の形式に従い、①～④を埋めた文を入力してください。</p>
      <div class="input-group">
        <input type="text" id="help-input" placeholder="入力してください" />
        <button id="help-submit-btn">確認</button>
      </div>
      <div id="help-result" style="margin-top: 15px; font-size: 16px; text-align: center;"></div>
    </div>

    <!-- <script src="../main.js"></script> -->
    <script>
      document.documentElement.style.setProperty(
        "--step-submit-hover",
        "#5ce1e6"
      );

      // Words list with additional related words
      const words = [
        "URL", "タイタン", "QRコード", "自分", "問題", "冊子", "タイトル", "セキュリティ",
        "サイト", "画面", "数字", "２", "７", "５", "文字", "earth", "universe", "watch",
        "rainbow", "star", "○×ゲーム", "地球のトレンド", "ストーリー", "変える", "動かす",
        "交換する", "取る", "足す", "やり直す", "直す", "飛ぶ", "燃やす", "勝つ", "負ける",
        // Additional related words
        "宇宙船", "ロケット", "燃料", "エンジン", "発射", "軌道", "惑星", "衛星", 
        // 20 more words
        "太陽", "月", "星", "銀河", "彗星", "小惑星", "大気", "酸素", "水", "氷",
        "温度", "圧力", "速度", "時間", "距離", "方向", "角度", "位置", "座標", "データ",
        "asari","2025","in","on","dog","cat","planet","moon","sun","galaxy","comet","asteroid","water","time","angle",
        "97","62","41"
      ];

      // Shuffle function
      function shuffleArray(array) {
        const shuffled = [...array];
        for (let i = shuffled.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
        }
        return shuffled;
      }

      // Populate and shuffle words
      document.addEventListener('DOMContentLoaded', function() {
        const wordsGrid = document.getElementById('words-grid');
        const shuffledWords = shuffleArray(words);
        
        shuffledWords.forEach(word => {
          const span = document.createElement('span');
          span.textContent = word;
          wordsGrid.appendChild(span);
        });
      });

      // Help button functionality
      document.getElementById("help-btn").onclick = function() {
        const helpSection = document.getElementById("help-section");
        helpSection.style.display = helpSection.style.display === "none" ? "block" : "none";
      };

      // Help input functionality
      document.getElementById("help-submit-btn").onclick = function() {
        const input = document.getElementById("help-input").value.trim();
        const result = document.getElementById("help-result");
        
        if (input === "URLのearthをuniverseに変える") {
          result.innerHTML = '<a href="https://rincotan.github.io/asari2025/taitan_in_universe/index.html" target="_blank" style="color: #2277ee; text-decoration: underline;">https://rincotan.github.io/asari2025/taitan_in_universe/index.html</a>';
          result.style.color = "#2277ee";
        } else {
          result.innerHTML = "正しい入力ではありません。";
          result.style.color = "#ff4444";
        }
      };

      // Allow Enter key to submit help input
      document.getElementById("help-input").addEventListener("keypress", function(e) {
        if (e.key === "Enter") {
          document.getElementById("help-submit-btn").click();
        }
      });
    </script>
    <div class="footer-text">in earth</div>
  </body>
</html>
