<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <title>STEPページ</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <!-- <div id="pc-warning">※スマホ専用サイトです。スマートフォンでご利用ください。</div> -->
    <div class="page active">
      <h2 id="step-title"></h2>

      <div class="story-box">
        冊子と5枚の謎を組み合わせて
        <div>彼の名前を導こう</div>
      </div>
      <button class="story-btn">ストーリーを振り返る</button>

      <!-- STEP内の小問ボタン -->
      <div id="problem-grid"></div>

      <!-- STEP解答欄 -->
      <div class="input-group">
        <input
          type="text"
          id="step-input"
          placeholder="ひらがなと半角数字のみで入力してね"
        />
        <button id="step-submit">決定</button>
      </div>
      <button id="hint-btns">ヒント</button>
      <!-- ヒントボタンのすぐ下に追加 -->
      <div id="hint-area" style="display: none">
        <!-- STEP1のヒント -->
        <div class="step1-hints" style="display: none">
          <details open>
            <summary>ヒント1</summary>
            今までの答えというのは、このサイトで解いた5問の答えです。
            枠の中の数字がそれぞれの問題番号を指しています。
          </details>
          <details>
            <summary>ヒント2</summary>
            入力した答えそのままではしりとりは成立しません。今までの問題を見返してみましょう。
          </details>
          <details>
            <summary>ヒント3</summary>
            問題3を見てみましょう。
          </details>
          <details>
            <summary>ヒント4</summary>
            二重の四角は英語に変換する印でした。
          </details>
          <details>
            <summary>ヒント5</summary>
            「とけい」は問題3より、watchで考えればいいとわかります。
            英語でしりとりをして、線でつなぎましょう。
          </details>
        </div>

        <!-- STEP2のヒント -->
        <div class="step2-hints" style="display: none">
          <details open>
            <summary>ヒント1</summary>
            まずは答えを書き出してみましょう。
          </details>
          <details>
            <summary>ヒント2</summary>
            「7つの謎」とありますが、7つ目の謎とはなんでしょうか。
          </details>
          <details>
            <summary>ヒント3</summary>
            7つ目の謎とはこのクロスワードのことです。
          </details>
          <details>
            <summary>ヒント4</summary>
            つまり、このクロスワードを完成させることができればこの謎の答えもわかるようです。
          </details>
          <details>
            <summary>ヒント5</summary>
            「この謎の答えは2文字」とあることから、4文字が入るマスが1つ多く、3文字が入るマスと2文字入るマスが1つずつ足りないことがわかります。
          </details>
          <details>
            <summary>ヒント6</summary>
            右側縦4文字のマスの3文字目のマスを、縦3マスの1文字目と右側縦4文字のマスの2文字目の間に移動しましょう。
          </details>
          <details>
            <summary>ヒント7</summary>
            「問題4の答えは縦の鍵」に注意して埋めましょう。問題1～6の答え以外の言葉が、このクロスワードの答えです。
          </details>
        </div>

        <!-- STEP3のヒント -->
        <div class="step3-hints" style="display: none">
          <details open>
            <summary>ヒント1</summary>
            まずは最初の指示の通りに並べてみましょう
          </details>
          <details>
            <summary>ヒント2</summary>
            矢印の先の文字をつなげて読むと「鏡文字上から」となります
          </details>
          <details>
            <summary>ヒント3</summary>
            鏡文字を上から読むと「まわして灰色線繋ぎ通るもじ」となります
          </details>
          <details>
            <summary>ヒント4</summary>
            灰色の線を繋ぎ、通った文字を読むと「矢印の先下から」となります
          </details>
          <details>
            <summary>ヒント5</summary>
            下という字をよく見てみると文字に影かついていることがわかります
          </details>
          <details>
            <summary>ヒント6</summary>
            重ねた時に下になっているものから順番に矢印の先にある文字を読んでいきます
          </details>
        </div>
      </div>
    </div>

    <!-- Storyオーバーレイ -->
    <div id="story-overlay" style="display: none">
      <div class="story-bg"></div>
      <div class="story-center">
        <div class="intro-story">
          <h2 class="story-title">～STORY～</h2>
          <section id="story-section-step1" class="step-story-section">
            <div class="story-chat">
              <div class="message user">
                <div class="chat user">記憶喪失じゃん！！！</div>
                <img src="images/user_icon.png" alt="user icon" class="icon" />
              </div>

              <div class="message alien">
                <img
                  src="images/alien_icon.png"
                  alt="alien icon"
                  class="icon"
                />
                <div class="chat alien">
                  だだだだだ、大丈夫！！<br />はい、これ
                </div>
              </div>

              <div class="message user">
                <div class="chat user">
                  なにこれ…？<br />小さい紙5枚と…文字が散りばめられた紙？
                </div>
                <img src="images/user_icon.png" alt="user icon" class="icon" />
              </div>

              <div class="message alien">
                <img
                  src="images/alien_icon.png"
                  alt="alien icon"
                  class="icon"
                />
                <div class="chat alien">
                  これは僕の名刺！宇宙旅行中に出会った生き物に渡してるんだ〜
                </div>
              </div>

              <div class="message user">
                <div class="chat user">へ〜、もしかして謎解き？</div>
                <img src="images/user_icon.png" alt="user icon" class="icon" />
              </div>

              <div class="message alien">
                <img
                  src="images/alien_icon.png"
                  alt="alien icon"
                  class="icon"
                />
                <div class="chat alien">
                  そう！よくわかったね、謎解きで名前知ってもらったらずっと覚えててくれるかなと思って作ったんだ！
                </div>
              </div>

              <div class="message user">
                <div class="chat user">いいね。私謎解き大得意だよ</div>
                <img src="images/user_icon.png" alt="user icon" class="icon" />
              </div>

              <div class="message alien">
                <img
                  src="images/alien_icon.png"
                  alt="alien icon"
                  class="icon"
                />
                <div class="chat alien">自信作だけど、君に解けるかな…？</div>
              </div>

              <div class="message user">
                <div class="chat user">
                  ふっふっふ秒速で解いちゃうよ〜……って雑談してる場合じゃないよ！！<br />記憶喪失なんでしょ？そもそも、自信作なのにこれ見て思い出さないの？
                </div>
                <img src="images/user_icon.png" alt="user icon" class="icon" />
              </div>

              <div class="message alien">
                <img
                  src="images/alien_icon.png"
                  alt="alien icon"
                  class="icon"
                />
                <div class="chat alien">全然……</div>
              </div>

              <div class="message user">
                <div class="chat user">なんでよ…</div>
                <img src="images/user_icon.png" alt="user icon" class="icon" />
              </div>

              <div class="message alien">
                <img
                  src="images/alien_icon.png"
                  alt="alien icon"
                  class="icon"
                />
                <div class="chat alien">と、とにかく解いてみてよ</div>
              </div>
            </div>
          </section>

          <section id="story-section-step2" class="step-story-section">
            <div class="story-chat">
              <div class="message user">
                <div class="chat user">あなた、タイタンって言うのね！</div>
                <img src="images/user_icon.png" alt="user icon" class="icon" />
              </div>

              <div class="message alien">
                <img
                  src="images/alien_icon2.png"
                  alt="alien icon"
                  class="icon"
                />
                <div class="chat alien">
                  そう！僕はタイタン！！ありがとう！<br />君って謎解きが本当に得意なんだね！
                </div>
              </div>

              <div class="message user">
                <div class="chat user">えへへ…次もドンと来い！</div>
                <img src="images/user_icon.png" alt="user icon" class="icon" />
              </div>

              <div class="message alien">
                <img
                  src="images/alien_icon2.png"
                  alt="alien icon"
                  class="icon"
                />
                <div class="chat alien">
                  本当に助かるよ、君がいればすぐ帰れちゃいそう！
                </div>
              </div>

              <div class="message user">
                <div class="chat user">それでそれで？次何すればいい？</div>
                <img src="images/user_icon.png" alt="user icon" class="icon" />
              </div>

              <div class="message alien">
                <img
                  src="images/alien_icon2.png"
                  alt="alien icon"
                  class="icon"
                />
                <div class="chat alien">
                  そうだった、とりあえず宇宙船を見てくれないかな
                </div>
              </div>

              <div class="message user">
                <div class="chat user">うん！</div>
                <img src="images/user_icon.png" alt="user icon" class="icon" />
              </div>

              <div id="chat-dialog">―宇宙船の目の前―</div>

              <div class="message user">
                <div class="chat user">でっか…</div>
                <img src="images/user_icon.png" alt="user icon" class="icon" />
              </div>

              <div class="message alien">
                <img
                  src="images/alien_icon2.png"
                  alt="alien icon"
                  class="icon"
                />
                <div class="chat alien">
                  中を見せてあげたい所なんだけど、<br />緊急時の入り方を忘れちゃって…
                </div>
              </div>

              <div class="message user">
                <div class="chat user">
                  そんなことある！？あ、記憶喪失か…<br />なんでこうも重要なことばっかり…
                </div>
                <img src="images/user_icon.png" alt="user icon" class="icon" />
              </div>

              <div class="message alien">
                <img
                  src="images/alien_icon2.png"
                  alt="alien icon"
                  class="icon"
                />
                <div class="chat alien">
                  どうしたら開くんだっけ…<br />う〜ん……………………
                </div>
              </div>

              <div class="message user">
                <div class="chat user">あれ、ロケットになんか書いてあるよ</div>
                <img src="images/user_icon.png" alt="user icon" class="icon" />
              </div>

              <div id="chat-dialog">「うちゅうせんのあけかた」</div>

              <div class="message user">
                <div class="chat user">タイタン不用心すぎ！？</div>
                <img src="images/user_icon.png" alt="user icon" class="icon" />
              </div>
            </div>
          </section>

          <section id="story-section-step3" class="step-story-section">
            <div class="story-chat">
              <div class="message user">
                <div class="chat user">
                  かぎ？そんな当たり前な…ねぇタイタン？
                </div>
                <img src="images/user_icon.png" alt="user icon" class="icon" />
              </div>

              <div class="message alien">
                <img
                  src="images/alien_icon2.png"
                  alt="alien icon"
                  class="icon"
                />
                <div class="chat alien">あっ</div>
              </div>

              <div class="message user">
                <div class="chat user">えっ</div>
                <img src="images/user_icon.png" alt="user icon" class="icon" />
              </div>

              <div class="message alien">
                <img
                  src="images/alien_icon2.png"
                  alt="alien icon"
                  class="icon"
                />
                <div class="chat alien">じゃじゃーん宇宙船のかぎ〜！</div>
              </div>

              <div class="message user">
                <div class="chat user">…</div>
                <img src="images/user_icon.png" alt="user icon" class="icon" />
              </div>

              <div class="message alien">
                <img
                  src="images/alien_icon2.png"
                  alt="alien icon"
                  class="icon"
                />
                <div class="chat alien">
                  ごっごめん！非常用のドアの鍵が別にあるってこと忘れてて…
                </div>
              </div>

              <div class="message user">
                <div class="chat user">
                  タイタンよくこれまで無事に旅してきたね…
                </div>
                <img src="images/user_icon.png" alt="user icon" class="icon" />
              </div>

              <div class="message alien">
                <img
                  src="images/alien_icon2.png"
                  alt="alien icon"
                  class="icon"
                />
                <div class="chat alien">
                  実は僕これまで通った惑星全部で墜落しちゃってて、この宇宙船もボロボロなんだ…
                </div>
              </div>

              <div class="message user">
                <div class="chat user">無事じゃないじゃん！</div>
                <img src="images/user_icon.png" alt="user icon" class="icon" />
              </div>

              <div class="message alien">
                <img
                  src="images/alien_icon2.png"
                  alt="alien icon"
                  class="icon"
                />
                <div class="chat alien">出発したとたんに墜落したり…</div>
              </div>

              <div class="message user">
                <div class="chat user">おつかれタイタン</div>
                <img src="images/user_icon.png" alt="user icon" class="icon" />
              </div>

              <div class="message alien">
                <img
                  src="images/alien_icon2.png"
                  alt="alien icon"
                  class="icon"
                />
                <div class="chat alien">
                  ありがとう！でももう宇宙船もあいたしまた旅に出れるよ！
                </div>
              </div>

              <div class="message user">
                <div class="chat user">
                  パスワードを入力してって書いてあるよ？
                </div>
                <img src="images/user_icon.png" alt="user icon" class="icon" />
              </div>

              <div class="message alien">
                <img
                  src="images/alien_icon2.png"
                  alt="alien icon"
                  class="icon"
                />
                <div class="chat alien">あ〜〜…</div>
              </div>

              <div class="message user">
                <div class="chat user">この流れは……</div>
                <img src="images/user_icon.png" alt="user icon" class="icon" />
              </div>

              <div class="message alien">
                <img
                  src="images/alien_icon2.png"
                  alt="alien icon"
                  class="icon"
                />
                <div class="chat alien">忘れちゃった！</div>
              </div>


            </div>
          </section>
          <button id="close-story">✕</button>
        </div>
      </div>
    </div>

    <div class="hamburger" id="hamburger">
      <div></div>
      <div></div>
      <div></div>
    </div>
    <div class="menu" id="menu">
      <a href="#" data-step="0">タイトル</a>
      <a href="#" data-step="1">STEP1</a>
      <a href="#" data-step="2" class="locked">STEP2</a>
      <a href="#" data-step="3" class="locked">STEP3</a>
      <a href="last.html" class="locked">Last</a>
    </div>

    <!-- STEP用モーダル（quizと共通の構造） -->
    <div id="result-modal" style="display: none">
      <div class="modal-bg"></div>
      <div class="modal-center">
        <div id="result-content"></div>
        <button id="modal-close-btn">✕ 閉じる</button>
        <button id="modal-next-btn" style="display: none">次へ→</button>
      </div>
    </div>
    <script src="main.js"></script>
    <script>
      const params2 = new URLSearchParams(window.location.search);
      const step = params2.get("step");

      // stepの値に応じてCSS変数を変更
      if (step === "1") {
        document.documentElement.style.setProperty(
          "--step-submit-hover",
          "#f7bfc7"
        );
      } else if (step === "2") {
        document.documentElement.style.setProperty(
          "--step-submit-hover",
          "#7991ff"
        );
        console.log("出てこい!!!!!!!!!!!!!!");
      } else if (step === "3") {
        document.documentElement.style.setProperty(
          "--step-submit-hover",
          "#ffde59"
        );
      }

      // ヒントボタンの表示切替
      const hintBtn = document.getElementById("hint-btns");
      const hintArea = document.getElementById("hint-area");

      if (hintBtn && hintArea) {
        hintBtn.addEventListener("click", function () {
          // 現在のSTEPに応じてヒントを表示
          const step1Hints = document.querySelector(".step1-hints");
          const step2Hints = document.querySelector(".step2-hints");
          const step3Hints = document.querySelector(".step3-hints");

          // すべてのヒントを非表示
          if (step1Hints) step1Hints.style.display = "none";
          if (step2Hints) step2Hints.style.display = "none";
          if (step3Hints) step3Hints.style.display = "none";

          // 現在のSTEPのヒントを表示
          if (step === "1" && step1Hints) {
            step1Hints.style.display = "block";
          } else if (step === "2" && step2Hints) {
            step2Hints.style.display = "block";
          } else if (step === "3" && step3Hints) {
            step3Hints.style.display = "block";
          }
          if (
            hintArea.style.display === "none" ||
            hintArea.style.display === ""
          ) {
            hintArea.style.display = "block";
          } else {
            hintArea.style.display = "none";
          }
        });
      }
    </script>
    <div class="footer-text">in earth</div>
  </body>
</html>
