<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <title>小問題ページ</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <!-- <div id="pc-warning">※スマホ専用サイトです。スマートフォンでご利用ください。</div> -->

    <div class="page active" style="text-align: center">
      <h2 id="quiz-title"></h2>
      <img id="quiz-img" src="" alt="" style="max-width: 80%; margin: 20px 0" />
      <div class="input-group">
        <input type="text" id="quiz-answer" placeholder="答えをひらがなで入力してください" />
        <button id="submit-btn">決定</button>
      </div>
      <p id="quiz-answer-result"></p>
      <div class="bottom-buttons">
        <button id="close-btn" onclick="goToStep(stepNum, true)">閉じる</button>
        <button id="hint-btn">ヒント</button>
        </div>
        <div id="hint-area" style="display:none;"></div>        
      </div>
    </div>

    <div class="hamburger" id="hamburger">
      <div></div>
      <div></div>
      <div></div>
    </div>
    <div class="menu" id="menu">
      <a href="#" data-step="0">タイトル</a>
      <a href="#" data-step="1">STEP1</a>
      <a href="#" data-step="2" class="locked">STEP2</a>
      <a href="#" data-step="3" class="locked">STEP3</a>
    </div>

    <!-- 正解・不正解モーダル -->
    <div id="result-modal" style="display:none;">
      <div class="modal-bg"></div>
      <div class="modal-center">
        <div id="result-content"></div>
        <button id="modal-close-btn">✕ 閉じる</button>
        <button id="modal-next-btn" style="display:none;">次の問題へ→</button>
      </div>
    </div>

    <script src="main.js"></script>

    <script>
      //const params = new URLSearchParams(window.location.search);
      //const stepNum = parseInt(params.get("step")) || 1;
      const quizNum = parseInt(params.get("quiz")) || 1;
      console.log(stepNum, quizNum);

      const quizData = {
        1: {
          1: {
            img: "images/q11.png",
            ans: "とけい",
            hints:[
              "時計に関する言葉です。",
              "時間を知るための道具です。",
              "腕や壁にかけて使います。",
              "アナログとデジタルがあります。",
              "英語では 'clock' や 'watch' と言います。"
            ]
          },
          2: { 
            img: "images/q12.png",
            ans: "ぞう",
            hints:[
              "大きな動物です。",
              "長い鼻を持っています。",
              "アフリカやアジアに生息しています。",
              "群れで生活します。",
              "英語では 'elephant' と言います。"
            ]
          },
          3: {
            img: "images/q13.png",
            ans: "いえ",
            hints:[
              "人が住む場所です。",
              "屋根と壁があります。",
              "家族と一緒に暮らします。",
              "家具や家電が置かれています。",
              "英語では 'house' と言います。"
            ]
          },
          4: {
            img: "images/q14.png",
            ans: "にじ",
            hints:[
              "雨の後に見えることがあります。",
              "七色の色が並んでいます。",
              "空にかかるアーチ状のものです。",
              "光の屈折によってできます。",
              "英語では 'rainbow' と言います。"
            ]
          },
          5: {
            img: "images/q15.png",
            ans: "とら",
            hints:[

            ]
          },
        },
        2: {
          1: {
            img: "images/q21.png",
            ans: "かみなり",
            hints:[
              "空で起こる自然現象です。",
              "雷鳴と稲光が特徴です。",
              "雨や嵐と一緒に発生することがあります。",
              "電気の放電現象です。",
              "英語では 'thunder' と言います。"
            ]
          },
          2: {
            img: "images/q22.png",
            ans: "さなぎ",
            hints:[
              "昆虫の成長過程の一つです。",
              "幼虫から成虫になる前の段階です。",
              "硬い殻に包まれています。",
              "蝶や蛾などがこの段階を経ます。",
              "英語では 'pupa' と言います。"
            ]
          },
          3: {
            img: "images/q23.png",
            ans: "かみ",
            hints:[

            ]
          },
          4: {
            img: "images/q24.png",
            ans: "さんま",
            hints:[

            ]
          },
          5: {
            img: "images/q25.png",
            ans: "かまきり",
            hints:[

            ]
          },
          6: {
            img: "images/q26.png",
            ans: "かたな",
            hints:[

            ]
          },
        },

        3: {
          1: {
            img: "images/q31.png",
            ans: "未定",
            hints:[

            ]
          },
          2: {
            img: "images/q32.png",
            ans: "さい",
            hints:[
              "動物に関する言葉です。",
              "大きな体と角が特徴です。",
              "草食動物で、アフリカに生息しています。",
              "絶滅危惧種に指定されています。",
              "英語では 'rhinoceros' と言います。"
            ]
          },
          3: {
            img: "images/q33.png",
            ans: "はんげつ",
            hints:[
              "月に関する言葉です。",
              "半分の形をしています。",
              "夜空に見えることが多いです。",
              "満月の半分の状態です。",
              "英語では 'half moon' と言います。"
            ]
          },
          4: {
            img: "images/q34.png",
            ans: "じんせい",
            hints:[
              "人生に関する言葉です。",
              "人が生きていく過程を指します。",
              "喜びや悲しみ、成功や失敗があります。",
              "一度きりの貴重なものです。",
              "英語では 'life' と言います。"
            ]
          },
          5: {
            img: "images/q35.png",
            ans: "あいこ",
            hints:[
              "じゃんけんに関する言葉です。",
              "勝ちでも負けでもない状態です。",
              "同じ手を出した時に起こります。",
              "もう一度じゃんけんをすることが多いです。",
              "英語では 'draw' や 'tie' と言います。"
            ]
          },
          6: {
            img: "images/q361.png",
            ans: "star",
            hints:[
              "英語の単語です。",
              "夜空に輝くものです。",
              "形は五角形に似ています。",
              "よく願い事をする時に使います。",
              "日本語では 'ほし' と言います。"
            ]
          },
        },
      };

      document.getElementById(
        "quiz-title"
      ).innerText = `STEP${stepNum} 問題${quizNum}`;
      document.getElementById("quiz-img").src = quizData[stepNum][quizNum].img;
      document
        .getElementsByClassName("page")[0]
        .classList.add(`quiz${stepNum}`);

      document.getElementById("submit-btn").onclick = () => {
        checkQuizAnswer("quiz-answer", quizData[stepNum][quizNum].ans);
      };
      console.log(document.getElementById("submit-btn").onclick);

      // ステップ3小問6だけズーム画像切り替え
      if (stepNum === 3 && quizNum === 6) {
        const zoomImages = [
          "images/q361.png", // 通常
          "images/q362.png", // ズーム1
          "images/q363.png"  // ズーム2
        ];
        let zoomLevel = 0;
        const quizImg = document.getElementById("quiz-img");
        quizImg.src = zoomImages[zoomLevel];
        quizImg.style.cursor = "zoom-in";
        quizImg.onclick = function () {
          if (zoomLevel < zoomImages.length - 1) {
            zoomLevel++;
            quizImg.src = zoomImages[zoomLevel];
            quizImg.style.cursor = zoomLevel === zoomImages.length - 1 ? "zoom-out" : "zoom-in";
          } else {
            // ズームアウト
            zoomLevel = 0;
            quizImg.src = zoomImages[zoomLevel];
            quizImg.style.cursor = "zoom-in";
          }
        };
      }

      document.getElementById("hint-btn").onclick = function() {
        const area = document.getElementById("hint-area");
        // ヒント内容を生成
        const hints = quizData[stepNum][quizNum].hints;
        let html = "";
        hints.forEach((hint, i) => {
          html += `<details${i === 0 ? " open" : ""}>
            <summary>${i === 0 ? "" : ""} ヒント${i + 1}</summary>
            ${hint}
          </details>`;
        });
        area.innerHTML = html;
        area.style.display = (area.style.display === "none" || area.style.display === "") ? "block" : "none";
      };
    </script>

  </body>
</html>